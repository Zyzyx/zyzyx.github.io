<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.74.2" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>InMotion Hacked&nbsp;&ndash;&nbsp;Jay Greguske&#39;s Website</title><link rel="stylesheet" href="/css/core.min.b18f2982ffabb9bf1c023028ecd7487c21258c5bc6821ce655ba275a5c63121a979437a47dd580a96c2b448e5eee0f78.css" integrity="sha384-sY8pgv&#43;rub8cAjAo7NdIfCEljFvGghzmVbonWlxjEhqXlDekfdWAqWwrRI5e7g94"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="InMotion Hacked" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">Jay Greguske's Website</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/about">About</a><a class="nav item" href="/blog">Blog</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">InMotion Hacked</h1><p class="article date">2011-09-25</p></section><article class="article markdown-body"><p>About half an hour ago, Sans sent me a text saying I should check my brolem site and that I made a friend. Indeed I did, what I saw is the pic on the right.</p>
<p>More details on the hack are here, which I found with a google search of Tiger-Mate. InMotion is the hosting provider for Brolem.net, and multiple accounts were defaced, not just ours. The &ldquo;payload&rdquo; of the attack, and I confirmed this with InMotion support, is to drop an index.php file in any directory that looks like an application root for popular CMS installations, such as Drupal. Fixing the hack was just a matter of copying back my original index.php.</p>
<p>Interestingly, I found a couple references to a similar attack in 2010 against Google, so apparently this kid really needs attention. I say kid because the payload makes me think of a teen script kiddie. I would much rather be pwned by someone I could learn from.</p>
<p>In any case, I&rsquo;m going to reinstall Drupal some time this week (the release we have now is current) to be sure there aren&rsquo;t more index.php files laying around. I have no reason to suspect the database (meaning your accounts and passwords) was compromised.</p>
<p>Update: There is some embedded shell code in the index.php file. Not sure if that targets the webserver or the javascript engine in the browser yet.</p>
<p>Update 2:It&rsquo;s javascript. Sans, if AV starts lighting up you know where it came from! I&rsquo;ll post details in the comments as I learn more.</p>
<p>Update 3: Attached the payload in a tarball, if you want to explore yourself. I recommend against opening it in a browser. On Windows, you can open tarballs with 7-Zip.</p>
<p>Multiple scripts were in the index.php.</p>
<p><!-- raw HTML omitted -->Script 1<!-- raw HTML omitted --> is responsible for the moving mini-browser-box animation. I think it is harmless.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->Script 2<!-- raw HTML omitted --> just checks for the browser name, it is trivial and does not actually run anything.</p>
<p><!-- raw HTML omitted -->Script 3<!-- raw HTML omitted --> de-obfuscates embedded GIF data. This could be dangerous, will look into what exactly that is.</p>
<p><!-- raw HTML omitted -->Script 4<!-- raw HTML omitted --> is like #2, merely for formatting. I guess script kiddies care about being browser compliant.</p>
<p><!-- raw HTML omitted -->Script 5<!-- raw HTML omitted --> downloads the [HACKED] jpeg image. Not sure if this has embedded exploits yet, but this could be bad too. You download from an obviously illicit site.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Finally, <!-- raw HTML omitted -->Script 6<!-- raw HTML omitted --> is run, which plays an embedded MP3.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Script 3 most likely contains malware, but 5 and 6 could too.</p>
</article></div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/blog/yum_repository/"><span class="iconfont icon-article"></span>Yum Repository</a></p><p><a class="link" href="/blog/hacking_articles_and_presentations/"><span class="iconfont icon-article"></span>Hacking Articles and Presentations</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">Jay Greguske's Website</p>
    <p class="powerby"><span>Powered&nbsp;by&nbsp;</span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span>&nbsp;&amp;&nbsp;</span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p></div></section></body>

</html>